define(["jquery","jqueryui","block_elbp/minicolors","block_elbp/raty","block_elbp/tinytbl","block_elbp/fileupload"],function($,ui,miniColors,raty,tinytbl,fileupload){void 0!==$.fn.raty&&($.fn.raty.defaults.path=M.cfg.wwwroot+"/blocks/elbp/js/jquery/plugins/raty/images");var client={},ELBP={};ELBP.www=M.cfg.wwwroot,ELBP.savedStates=new Array,ELBP.savedInputs={},ELBP.savedCommands=new Array,ELBP.commandPointer=0,ELBP.dockPosition=null,ELBP.pluginIcons={},ELBP.moodleVersion=null,ELBP.reloadOnUnPop=0,ELBP.tempData=null,ELBP.studentID=null,ELBP.courseID=null,ELBP.pluginGroup=null,ELBP.pluginIcons={},ELBP.strings={},ELBP.pluginScripts={},ELBP.push_script=function(a,b){ELBP.pluginScripts[a]=b},ELBP.bind_scripts=function(){$.each(ELBP.pluginScripts,function(a,b){b.bindings()})},ELBP.bind_script=function(a){void 0!==ELBP.pluginScripts[a]&&ELBP.pluginScripts[a].bindings()},ELBP.hide=function(a){$(a).hide()},ELBP.show=function(a){$(a).show()},ELBP.ajax=function(plugin,action,params,callback,callBefore){var url=ELBP.www+"/blocks/elbp/js/ajaxHandler.php";callBefore&&callBefore(),$.ajax({type:"POST",url:url,data:{plugin:plugin,action:action,params:params},error:function(a){ELBP.ajax_error(a.responseText),console.log("Error: "+a)},success:function(d){if(0===d.length||d.indexOf("<!DOCTYPE")>=0)return alert("No data was returned by this request. Your Moodle session may have timed out, please refresh the page and see if you need to login again."),!1;var e=ELBP.process_data_eval(d);null!=ELBP.tempData&&(d=ELBP.tempData,ELBP.tempData=null),callback&&callback(d),ELBP.ajax_callback(d),e&&eval(e)}})},ELBP.ajax_callback=function(a){ELBP.bind()},ELBP.ajax_error=function(a){$("#elbp_error_output").html("["+new Date+"] "+a),$("#elbp_error_output").slideDown("slow")},ELBP.process_data_eval=function(a){var b=/\[ELBP:JS\]([\s\S]+?)\[\/ELBP:JS\]/g,c=a.match(b);if(c){a=a.replace(b,"");for(var d="",e=0;e<c.length;e++)c[e]=c[e].replace(/(\[ELBP:JS\]|\[\/ELBP:JS\])/g,""),d+=c[e];return ELBP.tempData=a,d}return!1},ELBP.test_mis_connection=function(a,b,c,d,e,f){var g={type:a,host:b,user:c,pass:d,db:e},h="#elbp_config_test_conn";void 0!=f&&(h+="_"+f),ELBP.ajax(0,"test_mis_connection",g,function(a){$(h).html(a)},function(){$(h).html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},ELBP.pop=function(){ELBP.show("#elbp_blanket"),$("#elbp_popup").show("scale",{},1e3),$("body").css("overflow","hidden")},ELBP.unpop=function(a,b){ELBP.save_state(a),ELBP.hide("#elbp_blanket"),1==ELBP.fast_hide?$("#elbp_popup").hide():$("#elbp_popup").hide("scale",{},1e3),$("#elbp_popup").html(""),void 0!=a&&void 0!=b&&ELBP.dock(a,b),ELBP.reset_global_vars(),ELBP.reloadOnUnPop&&ELBP.load("group",ELBP.pluginGroup),$("body").css("overflow","auto")},ELBP.reset_global_vars=function(){ELBP.Targets.loaded_from=!1},ELBP.save_state=function(a){ELBP.savedStates[a]=$("#elbp_popup").clone(!0,!0),ELBP.savedInputs[a]={};var b=$("#elbp_popup :input");$(b).each(function(){var b=$(this).prop("tagName");if("BUTTON"!=b&&"submit"!=$(this).attr("type")){var c=$(this).attr("id"),d=$(this).attr("name"),e=$(this).val(),f=!!$(this).is(":checked"),g="";if($(this).hasClass("elbp_texteditor"))g=$("#"+c+"_ifr").length>0?$("#"+c+"_ifr").contents().find("html")[0]:$("#"+c+"editable").html(),ELBP.savedInputs[a][d]={value:g,checked:f};else if(void 0!=ELBP.savedInputs[a][d]&&ELBP.savedInputs[a][d]instanceof Object&&void 0==ELBP.savedInputs[a][d][0]){var h=ELBP.savedInputs[a][d];ELBP.savedInputs[a][d]=[h,{value:e,checked:f}]}else if(void 0!=ELBP.savedInputs[a][d]&&ELBP.savedInputs[a][d]instanceof Object&&ELBP.savedInputs[a][d][0]instanceof Object){var i=Object.keys(ELBP.savedInputs[a][d]).length;ELBP.savedInputs[a][d][i]={value:e,checked:f}}else ELBP.savedInputs[a][d]={value:e,checked:f}}})},ELBP.restore_state=function(a){if(void 0!=ELBP.savedStates[a]&&""!=ELBP.savedStates[a]&&""!=$(ELBP.savedStates[a]).html()){$("#elbp_popup").remove(),$.each(ELBP.savedInputs[a],function(b,c){var d=c.value,e=$.type(d);"object"==e&&$(d).find("body").length>0&&(d=$(d).find("body").html()),b=b.replace(/"/g,"&quot;");var f=$('input[name="'+b+'"], textarea[name="'+b+'"], select[name="'+b+'"]',ELBP.savedStates[a]),g=$(f).prop("tagName");if(f.length>1)for(var h=0;h<f.length;h++)switch(d=c[h].value,g){case"TEXTAREA":$(f[h]).text(d);break;case"INPUT":$(f[h]).attr("value",d),1==c[h].checked&&$(f[h]).attr("checked","checked");break;default:$(f[h]).attr("value",d)}else switch(g){case"TEXTAREA":$(f).text(d);break;case"SELECT":$('select[name="'+b+'"] option',ELBP.savedStates[a]).filter(function(){return $(this).val()==d}).attr("selected","selected");break;case"INPUT":$(f).attr("value",d),1==c.checked&&$(f).attr("checked","checked");break;default:$(f).attr("value",d)}}),$(ELBP.savedStates[a]).find(".elbp_texteditor").siblings("div").remove();var b=$(ELBP.savedStates[a]).html(),c=$(ELBP.savedStates[a]).first();$(c).css("display","none"),b="<div id='"+$(c).attr("id")+"' style='"+$(c).attr("style")+"' class='"+$(c).attr("class")+"'>"+b+"</div>",$("body").append(b),$("body").find("iframe").each(function(){var a=$(this).attr("id");if("elbpfe_"==a.substring(0,7)){var b=a.split("_");b[b.length-1]="parent";var c=b.join("_"),d=c.replace("_parent","");$(this).parents("#"+c).remove(),$("#"+d).css("display","block")}}),ELBP.show("#elbp_blanket"),$("#elbp_popup").show("explode",{},1e3),setTimeout(function(){ELBP.bind()},1500),$("body").css("overflow","hidden")}},ELBP.load=function(a,b){var c={type:a,id:b,student:ELBP.studentID,course:ELBP.courseID};ELBP.ajax(0,"load_template",c,function(a){$("#elbp_summary_boxes").html(a),ELBP.bind_scripts()},function(a){$("#elbp_summary_boxes").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},ELBP.load_expanded=function(a,b){var c={pluginname:a,student:ELBP.studentID,course:ELBP.courseID};ELBP.ajax(0,"load_expanded",c,function(c){$("#elbp_popup").html(c),ELBP.bind_script(a),b&&b()},function(a){ELBP.pop(),$("#elbp_popup").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},ELBP.set_group_class=function(a){$(".elbp_tabrow li").each(function(){$(this).attr("class","")}),$(a).parent().addClass("selected")},ELBP.apply_summary_hover=function(){$(".elbp_summary_box_wrapper").hover(function(){var a=$(this).height(),b=$(this)[0].scrollHeight;b>a&&$(this).next(".elbp_summary_box_footer").slideDown("slow")})},ELBP.load_image=function(a,b){setTimeout("$('#"+b+"').attr('src', '"+a+"');",500)},ELBP.apply_tooltip=function(){$(document).ready(function(){$(".elbp_tooltip").tooltip({content:function(){return $(this).prop("title")}})})},ELBP.expand=function(a){var b=$(a).siblings(".elbp_summary_box_wrapper")[0],c=b.scrollHeight+10;$(b).animate({height:c},300),$(a).attr("onclick","ELBP.contract(this);return false;"),$(a).attr("title",ELBP.strings.contract);var d=$(a).children("img");$(d).attr("src",$(d).attr("src").replace("switch_plus","switch_minus"))},ELBP.contract=function(a){var b=225,c=$(a).siblings(".elbp_summary_box_wrapper")[0];$(c).animate({height:b},300),$(a).slideUp("slow"),$(a).attr("onclick","ELBP.expand(this);return false;"),$(a).attr("title",ELBP.strings.expand);var d=$(a).children("img");$(d).attr("src",$(d).attr("src").replace("switch_minus","switch_plus"))},ELBP.set_view_link=function(a,b){void 0!==b?$(".elbp_view_link_"+b).removeClass("selected"):$(".elbp_view_link").removeClass("selected"),void 0!=a&&$(a).parent().addClass("selected")},ELBP.confirm_submit=function(){return window.confirm(ELBP.strings.areyousuredelete)},ELBP.resize_popup=function(){var a=$(window).width()/100*80,b=$(window).height()/100*80;$("#elbp_popup").css("height",b),$("#elbp_popup").css("width",a)},ELBP.dialogue=function(a,b,c){$("#elbp_dialogue div").html(b);var d={title:a,autoOpen:!0,autoResize:!0,show:"blind",hide:"blind",width:600,height:250,stack:!0,open:function(){$(".ui-button").removeClass("ui-state-focus")}};void 0!=c&&$.each(c,function(a,b){d[a]=b}),$("#elbp_dialogue").dialog(d)},ELBP.browser_supports=function(a){var b=document.createElement("input");try{b.type=a}catch(c){}return b.type===a},ELBP.toggle_image=function(a,b){$(b).attr("src",a)},ELBP.dock=function(a,b){if(!$("#docked_"+a)[0])if("bottom"==ELBP.dockPosition)$("#elbp_dock_list").append('<li id="docked_'+a+'"><a href="#" onclick="ELBP.load_from_dock(\''+a+'\');return false;" class="dock_plugin_name" title="'+ELBP.strings.loadsavedstate+": "+b+'">'+b+'</a> <a href="#" onclick="ELBP.undock(\''+a+'\');return false;" class="dock_plugin_close"><img src="'+ELBP.www+'/blocks/elbp/pix/close_tiny.png" alt="img" title="'+ELBP.strings.undock+": "+b+'" /></a></li>');else if("left"==ELBP.dockPosition){var c=ELBP.pluginIcons[a];$("#elbp_dock_list").append('<li id="docked_'+a+'"><a href="#" onclick="ELBP.load_from_dock(\''+a+"');return false;\" class=\"dock_plugin_name\" title=\"'+ELBP.strings['loadsavedstate']+': "+b+'"><img src="'+c+'" alt="'+b+'" /></a><br><a href="#" onclick="ELBP.undock(\''+a+'\');return false;" class="dock_plugin_close"><img src="\'+ELBP.www+\'/blocks/elbp/pix/close_tiny.png" alt="img" title="'+ELBP.strings.undock+": "+b+'" /></a></li>')}},ELBP.undock=function(a){$("#docked_"+a).remove(),ELBP.savedStates[a]=void 0,$("#elbp_popup_header_plugin_"+a)[0]&&ELBP.unpop()},ELBP.load_from_dock=function(a){void 0==$("#elbp_popup_header_plugin_"+a)[0]&&$(".elbp_popup_header")[0]&&(ELBP.fast_hide=!0,$("#close_expanded_view").click(),ELBP.fast_hide=!1),void 0!=ELBP.savedStates[a]&&""!=ELBP.savedStates[a]&&""!=$(ELBP.savedStates[a]).html()?ELBP.restore_state(a):ELBP.load_expanded(a)},ELBP.switch_users=function(param){if($("#switch_user_users").find("option").remove(),$("#switch_user_users").css("display","none"),$("#find_other_user").css("display","none"),""==param)return!1;var params={action:"load_users",param:param};ELBP.ajax(0,"switch_user",params,function(d){$("#switch_user_users").find("option").remove(),$("#switch_user_users").append('<option value=""></option>'),eval(d),$("#switch_users_loading").html(""),$("#switch_user_users option").length>1&&$("#switch_user_users").css("display","inline-block")},function(){$("#find_other_user").remove(),$("#switch_users_loading").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" style="height:10px;" />')})},ELBP.switch_user=function(a,b){if(""==a||a==ELBP.studentID)return!1;var c=window.location.href;c=c.replace(/id=[\d]+/g,"id="+a),c=c.indexOf("cID")>-1?c.replace(/cID=(.+)/g,"cID="+b):c+"&cID="+b,window.location=c},ELBP.switch_search_user=function(search){if(""==search)return!1;var params={action:"load_users",search:search};ELBP.ajax(0,"search_load_student",params,function(d){$("#switch_users_loading").html(""),eval(d)},function(){$("#switch_users_loading").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" style="height:10px;" />')})},ELBP.my_settings=function(a){var b={buttons:{Save:function(){$(this).dialog("close"),ELBP.save_my_settings(""+a)},Close:function(){$(this).dialog("close")}},height:400},c={student:ELBP.studentID,userID:a};$("#mysettingsimg").attr("src",ELBP.www+"/blocks/elbp/pix/loader.gif"),ELBP.ajax(0,"load_my_settings",c,function(a){ELBP.dialogue(ELBP.strings.mysettings,a,b),$("#mysettingsimg").attr("src",ELBP.www+"/blocks/elbp/pix/icons/cog.png")})},ELBP.save_my_settings=function(a){var b={};b=void 0==a||"undefined"==a||""==a?{data:$("#my_settings").serialiseObject()}:{data:$("#my_settings").serialiseObject(),userID:a},ELBP.ajax(0,"save_my_settings",b,function(a){location.reload(!0)})},ELBP.apply_colour_picker=function(){ELBP.browser_supports("color")||$('input[type="color"]').each(function(){$(this).minicolors()})},ELBP.course_picker={choose_category:function(a,b,c){var d={action:"choose_category",catID:a,use:c};ELBP.ajax(0,"course_picker",d,function(a){$($(b).siblings("#category_picker_pick_courses").children("input")[0]).val(""),$($(b).siblings("#category_picker_pick_courses").children("select")[0]).html(a),$(b).siblings("#category_picker_pick_courses").css("display","block")})},search_course:function(a,b,c){var d=$($($(b).parents()[1]).children()[0]).val(),e={action:"search_courses",catID:d,search:a,use:c};ELBP.ajax(0,"course_picker",e,function(a){$($(b).siblings("select")[0]).html(a)})},add:function(a){var b=$(a).parents()[0],c=$(b).siblings(".elbp_course_picker_search_div")[0],d=$(c).children("#category_picker_pick_courses")[0],e=$(d).children("select.course_list")[0],f=$(e).val();if(null!=f){var g=$(e).children("option"),h=new Array;$.each(g,function(a,b){h[b.value]=b.innerHTML});var i=$(b).siblings(".elbp_course_picker_chosen_div")[0],j=$(i).children("select.courseholder")[0],k=$(j).siblings(".coursepickerhiddeninputs")[0],l=$(k).attr("fieldname"),m=$(j).children("option"),n=new Array;$.each(m,function(a,b){n.push(b.value)}),$.each(f,function(a,b){$.inArray(b,n)===-1&&($(j).append('<option value="'+b+'">'+h[b]+"</option>"),$(k).append('<input type="hidden" name="'+l+'[]" value="'+b+'" />'))})}},remove:function(a){var b=$(a).parents()[0],c=$(b).siblings(".elbp_course_picker_chosen_div")[0],d=$(c).children("select.courseholder")[0],e=$(d).siblings(".coursepickerhiddeninputs")[0],f=$(d).val();null!=f&&$.each(f,function(a,b){$(d).children('option[value="'+b+'"]').remove(),$(e).children('input[value="'+b+'"]').remove()})}},ELBP.user_picker={search_user:function(a,b){var c={action:"search_users",search:a};ELBP.ajax(0,"user_picker",c,function(a){$($(b).siblings("select")[0]).html(a)})},add:function(a){var b=$(a).parents()[0],c=$(b).siblings(".elbp_user_picker_search_div")[0],d=$(c).children(".user_list")[0],e=$(d).val();if(null!=e){var f=$(d).children("option"),g=new Array;$.each(f,function(a,b){g[b.value]=b.innerHTML});var h=$(b).siblings(".elbp_user_picker_chosen_div")[0],i=$(h).children(".userholder")[0],j=$(i).siblings(".userpickerhiddeninputs")[0],k=$(j).attr("fieldname"),l=$(i).children("option"),m=new Array;$.each(l,function(a,b){m.push(b.value)}),$.each(e,function(a,b){$.inArray(b,m)===-1&&($(i).append('<option value="'+b+'">'+g[b]+"</option>"),$(j).append('<input type="hidden" name="'+k+'[]" value="'+b+'" />'))})}},remove:function(a){var b=$(a).parents()[0],c=$(b).siblings(".elbp_user_picker_chosen_div")[0],d=$(c).children(".userholder")[0],e=$(d).siblings(".userpickerhiddeninputs")[0],f=$(d).val();null!=f&&$.each(f,function(a,b){$(d).children('option[value="'+b+'"]').remove(),$(e).children('input[value="'+b+'"]').remove()})}},ELBP.validate_form=function(a){var b=0,c=$(a).attr("id");$("#"+c+" input, #"+c+" select, #"+c+" textarea").removeClass("elbp_red"),$("span.elbp_error").remove();var d="";return $("#"+c+" input, #"+c+" select, #"+c+" textarea").each(function(){var a=$(this),e=$(this).val();if(e=$.trim(e),$(this).hasClass("elbp_texteditor")){var f=$("#"+$(this).attr("id")+"editable");f.length>0?(e=f.html(),"<p><br></p>"==e&&(e="")):e=$(this).val(),e=$.trim(e)}if(void 0!=$(this).attr("validation")){var g=$(this).attr("validation").split(","),h=$(this).attr("type"),i=$(this).attr("name");$.each(g,function(f,g){switch(g){case"NOT_EMPTY":case"REQUIRED":if("radio"==h||"checkbox"==h){var j=$("#"+c+' input[name="'+i+'"]'),k=0;$.each(j,function(){if(1==$(this).prop("checked"))return k++,!1}),0==k&&(""==d&&(d=a),b++,$($(j)[0]).siblings("span.elbp_error").remove(),$($(j)[0]).addClass("elbp_red"),$($(j)[0]).before('<span class="elbp_error"><br>'+ELBP.strings["validation:required:tickbox"]+"<br></span> "))}else{var l=/.+/;null==e.match(l)&&(""==d&&(d=a),b++,$(a).addClass("elbp_red"),$(a).after('<span class="elbp_error"><br>'+ELBP.strings["validation:required"]+"</span>"))}break;case"TEXT_ONLY":var l=/[^a-z ]/i;null==e.match(l)&&""!=e||(""==d&&(d=a),b++,$(a).addClass("elbp_red"),$(a).after('<span class="elbp_error"><br>'+ELBP.strings["validation:textonly"]+"</span>"));break;case"NUMBERS_ONLY":var l=/^[0-9]+\.?[0-9]*$/i;null!=e.match(l)&&""!=e||(""==d&&(d=a),b++,$(a).addClass("elbp_red"),$(a).after('<span class="elbp_error"><br>'+ELBP.strings["validation:numbersonly"]+"</span>"));break;case"ALPHANUMERIC_ONLY":var l=/[^0-9 a-z]/i;null==e.match(l)&&""!=e||(""==d&&(d=a),b++,$(a).addClass("elbp_red"),$(a).after('<span class="elbp_error"><br>'+ELBP.strings["validation:alphanumericonly"]+"</span>"));break;case"EMAIL":var l=/^[a-z0-9_\.]+@[a-z0-9\.]+\.[a-z\.]{2,4}[a-z]{1}$/i;null!=e.match(l)&&""!=e||(""==d&&(d=a),b++,$(a).addClass("elbp_red"),$(a).after('<span class="elbp_error"><br>'+ELBP.strings["validation:email"]+"</span>"));break;case"PHONE":var l=/^(\+\d{1,}\s?)?0\d{4}\s?\d{6}$/;null!=e.match(l)&&""!=e||(""==d&&(d=a),b++,$(a).addClass("elbp_red"),$(a).after('<span class="elbp_error"><br>'+ELBP.strings["validation:phone"]+"</span>"));break;case"DATE":var l=/^\d{2}\-\d{2}\-\d{4}$/;null!=e.match(l)&&""!=e||(""==d&&(d=a),b++,$(a).addClass("elbp_red"),$(a).after('<span class="elbp_error"><br>'+ELBP.strings["validation:date"]+"</span>"));break;case"URL":var l=/(((http|ftp|https):\/{2})+(([0-9a-z_-]+\.)+(aero|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|pro|tel|travel|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mn|mn|mo|mp|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|nom|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ra|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sj|sk|sl|sm|sn|so|sr|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw|arpa)(:[0-9]+)?((\/([~0-9a-zA-Z\#\+\%@\.\/_-]+))?(\?[0-9a-zA-Z\+\%@\/&\[\];=_-]+)?)?))\b/im;null!=e.match(l)&&""!=e||(""==d&&(d=a),b++,$(a).addClass("elbp_red"),$(a).after('<span class="elbp_error"><br>'+ELBP.strings["validation:url"]+"</span>"))}})}}),!(b>0)||(""!=d&&$(d).focus(),!1)},ELBP.execute=function(a){if(ELBP.savedCommands.push(a),ELBP.commandPointer=ELBP.savedCommands.length,"clear"==a)return $("#cmd_output").html(""),$("#cmd_input input").val(""),!0;if("quit"===a||"exit"===a)return $("#cmd_input input").val(""),$("#elbp_admin_blanket").hide(),$("body").css("overflow","auto"),!0;var b={action:a};$("#cmd_input input").val(""),ELBP.ajax(0,"execute",b,function(a){$("#cmd_output").append(a+"<br>"),$(function(){var a=$("#cmd_output")[0].scrollHeight;$("#cmd_output").scrollTop(a)})})},ELBP.load_helper=function(a){window.open(ELBP.www+"/blocks/elbp/help.php?f="+a,"targetWindow","toolbar=no,location=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=800,height=600")},ELBP.Targets={loaded_type:!1,load_display:function(a,b,c,d,e){var f={type:a,studentID:ELBP.studentID,courseID:ELBP.courseID,loadedFrom:d,putInto:e};ELBP.ajax("Targets","load_display_type",f,function(a){$("#elbp_targets_content").html(a),ELBP.set_view_link(b),void 0!=c&&c()},function(a){$("#elbp_targets_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},load_targets:function(a,b){ELBP.Targets.loaded_type=!0;var c=function(){ELBP.Targets.loaded_type=!1};ELBP.load_expanded("Targets",function(){ELBP.Targets.load_display(a,$("#statustab_"+a),function(){void 0!=b&&($("#target_content_"+b).show(),$("div#elbp_popup").scrollTop(0),$("div#elbp_popup").animate({scrollTop:$("#elbp_target_id_"+b).offset().top-$("#elbp_target_id_"+b).height()},2e3))}),c()})},save_target:function(form,loadedFrom,putInto){""==putInto&&(putInto=void 0);var data=form.serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID,loadedFrom:loadedFrom,putInto:putInto}),ELBP.ajax("Targets","save_target",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#new_target_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},edit_target:function(a,b,c){var d={type:"edit",targetID:a,studentID:ELBP.studentID,courseID:ELBP.courseID,loadedFrom:b,putInto:c};ELBP.ajax("Targets","load_display_type",d,function(a){$("#elbp_targets_content").html(a)},function(a){$("#elbp_targets_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},delete_target:function(id){var confirm=window.confirm(ELBP.strings.areyousuredelete);if(confirm){var params={type:"delete",targetID:id,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("Targets","delete_target",params,function(d){eval(d)})}},add_comment:function(id,comment,parentID){var params={targetID:id,comment:comment,parentID:parentID};ELBP.ajax("Targets","add_comment",params,function(d){eval(d)})},delete_comment:function(targetID,commentID){var params={targetID:targetID,commentID:commentID};ELBP.ajax("Targets","delete_comment",params,function(d){eval(d)})},update_status:function(targetID,statusID){var params={targetID:targetID,statusID:statusID};ELBP.ajax("Targets","update_status",params,function(d){eval(d)})},forward_email:function(targetID,usernames){$("#email-success-"+targetID).hide(),$("#email-error-"+targetID).hide(),$("#email-to-addr-"+targetID).hide(),$("#email-loading-img-"+targetID).show();var params={targetID:targetID,usernames:usernames};ELBP.ajax("Targets","forward_email",params,function(d){eval(d),$("#email-loading-img-"+targetID).hide(),$("#email-to-addr-"+targetID).show()})},filter:function(a){$(".elbp_target").show(),void 0!==a&&""!=a&&$(".elbp_target").each(function(){var b=$(this).attr("filter-attribute");b!=a&&$(this).hide()})}},ELBP.StudentProfile={edit_link:function(a,b){$(a).find(".elbp_studentprofile_edit_link").css("display",b)},edit:function(a){var b="elbp_studentprofile_"+a+"_simple",c="elbp_studentprofile_"+a+"_edit",d="#elbp_studentprofile_"+a+"_edit_link";ELBP.hide("."+b+", #"+b),ELBP.show("."+c+", #"+c),$(d).text("["+ELBP.strings.save+"]"),$(d).attr("onclick",'ELBP.StudentProfile.save("'+a+'");return false;'),$(d).after('<a href="#" id="cancel_link_'+a+'" onclick="ELBP.StudentProfile.edit_return(\''+a+"');$(this).remove();return false;\">["+ELBP.strings.cancel+"]</a>")},edit_return:function(a){var b="elbp_studentprofile_"+a+"_edit",c="elbp_studentprofile_"+a+"_simple",d="#elbp_studentprofile_"+a+"_edit_link";ELBP.hide("."+b+", #"+b),ELBP.show("."+c+", #"+c),$(d).text(ELBP.strings.edit),$(d).attr("onclick",'ELBP.StudentProfile.edit("'+a+'");return false;')},return_details:function(a){a&&$.each(a,function(a,b){var c="#elbp_studentprofile_details_simple_"+a;$(c).text(b)})},return_info:function(a){$("#elbp_studentprofile_info_simple").html(a)},save:function(a){if("details"==a){var b=$(".elbp_studentprofile_details_edit_values"),c={};$.each(b,function(){var a=this.name;c[a]=this.value}),c.studentID=ELBP.studentID,ELBP.StudentProfile.update_details(c)}else if("info"==a){var d="";d=$("#student_info_textarea_ifr").length>0?$("#student_info_textarea_ifr").contents().find("body").html():$("#student_info_textareaeditable").length>0?$("#student_info_textareaeditable").html():$("#student_info_textarea").val();var c={studentID:ELBP.studentID,info:d,element:"student_info_textarea"};ELBP.StudentProfile.update_info(c)}$("#cancel_link_"+a).remove()},update_details:function(params){ELBP.ajax("StudentProfile","update_details",params,function(d){ELBP.StudentProfile.edit_return("details"),ELBP.StudentProfile.return_details(params),eval(d),$("#student_profile_output").html("")},function(){$("#student_profile_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},update_info:function(a){ELBP.ajax("StudentProfile","update_info",a,function(){ELBP.StudentProfile.edit_return("info"),ELBP.StudentProfile.return_info(a.info),$("#student_profile_output").html("")},function(){$("#student_profile_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},ELBP.Attendance={load_display:function(a,b){var c={type:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("Attendance","load_display_type",c,function(a){$("#elbp_attendance_content").html(a),ELBP.set_view_link(b)},function(a){$("#elbp_attendance_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},ELBP.Timetable={load_display:function(a,b){var c={type:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("elbp_timetable","load_display_type",c,function(a){$("#elbp_timetable_content").html(a),ELBP.set_view_link(b),ELBP.bind_script("elbp_timetable")},function(a){$("#elbp_timetable_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},load_colour_settings:function(){var a={buttons:{Save:function(){ELBP.Timetable.save_colour_settings(),$(this).dialog("close")},Close:function(){$(this).dialog("close")}},height:400},b={student:ELBP.studentID};ELBP.ajax("elbp_timetable","load_colours_form",b,function(b){ELBP.dialogue(ELBP.strings.changecolours,b,a)})},save_colour_settings:function(){var a={MON:$("#monday_colour").val(),TUE:$("#tuesday_colour").val(),WED:$("#wednesday_colour").val(),THU:$("#thursday_colour").val(),FRI:$("#friday_colour").val(),SAT:$("#saturday_colour").val(),SUN:$("#sunday_colour").val(),student:ELBP.studentID};ELBP.ajax("elbp_timetable","save_colours_form",a,function(){$(".elbp_timetable_monday").css("background-color",a.MON),$(".elbp_timetable_monday a").css("background-color",a.MON),ELBP.Timetable.update_font_colour(".elbp_timetable_monday",a.MON),$(".elbp_timetable_tuesday").css("background-color",a.TUE),$(".elbp_timetable_tuesday a").css("background-color",a.TUE),ELBP.Timetable.update_font_colour(".elbp_timetable_tuesday",a.TUE),$(".elbp_timetable_wednesday").css("background-color",a.WED),$(".elbp_timetable_wednesday a").css("background-color",a.WED),ELBP.Timetable.update_font_colour(".elbp_timetable_wednesday",a.WED),$(".elbp_timetable_thursday").css("background-color",a.THU),$(".elbp_timetable_thursday a").css("background-color",a.THU),ELBP.Timetable.update_font_colour(".elbp_timetable_thursday",a.THU),$(".elbp_timetable_friday").css("background-color",a.FRI),$(".elbp_timetable_friday a").css("background-color",a.FRI),ELBP.Timetable.update_font_colour(".elbp_timetable_friday",a.FRI),$(".elbp_timetable_saturday").css("background-color",a.SAT),$(".elbp_timetable_saturday a").css("background-color",a.SAT),ELBP.Timetable.update_font_colour(".elbp_timetable_saturday",a.SAT),$(".elbp_timetable_sunday").css("background-color",a.SUN),$(".elbp_timetable_sunday a").css("background-color",a.SUN),ELBP.Timetable.update_font_colour(".elbp_timetable_sunday",a.SUN)})},update_font_colour:function(a,b){ELBP.ajax("elbp_timetable","get_font_colour",{background:b},function(b){$(a).css("color",b),$(a+" a").css("color",b)})},load_calendar:function(a,b,c){"undefined"!=typeof b&&null!=b&&($("#elbp_tt_type li a").removeClass("sel"),$(b).addClass("sel"));var d=0,e=!1;"undefined"!=typeof c&&"undefined"!=typeof c.add&&("today"==c.add?e=!0:d=c.add),ELBP.ajax("elbp_timetable","load_calendar",{student:ELBP.studentID,type:a,format:!0,add:d},function(a){$("#elbp_tt_content").html(a),e&&($(".elbp_today").css("background-color","#FBFFB7"),$(".elbp_today").css("color","#000000")),ELBP.apply_tooltip()},function(a){$("#elbp_tt_content").html('<div class="elbp_centre"><img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" /></div>')})},week:function(a){ELBP.Timetable.load_calendar("week",null,{add:a})},day:function(a){ELBP.Timetable.load_calendar("day",null,{add:a})},month:function(a){ELBP.Timetable.load_calendar("month",null,{add:a})},year:function(a){ELBP.Timetable.load_calendar("year",null,{add:a})},popup_class_info:function(a,b){var c=$("#class_info_"+a).html();c="<div class='day_number'>"+b+"</div>"+c,ELBP.dialogue(ELBP.strings.lessoninfo,c)}},ELBP.Tutorials={load_display:function(a,b){var c={type:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("Tutorials","load_display_type",c,function(a){$("#elbp_tutorials_content").html(a),ELBP.set_view_link(b)},function(a){$("#elbp_tutorials_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},load_tutorial:function(a){ELBP.load_expanded("Tutorials",function(){setTimeout("$('#tutorial_content_"+a+"').slideDown();$('div#elbp_popup').scrollTop(0);$('div#elbp_popup').animate({ scrollTop: ($('#elbp_tutorial_"+a+"').offset().top - $('#elbp_tutorial_"+a+"').height()) }, 2000);",1e3)})},add_target:function(a){ELBP.save_state("Tutorials"),ELBP.dock("Tutorials",a),ELBP.Targets.loaded_from="Tutorials",ELBP.load_expanded("Targets",function(){ELBP.Targets.load_display("new",void 0,void 0,"Tutorials","elbp_tutorial_new_targets")})},edit_target:function(a,b){ELBP.save_state("Tutorials"),ELBP.dock("Tutorials",b),ELBP.Targets.loaded_from="Tutorials",ELBP.load_expanded("Targets",function(){ELBP.Targets.edit_target(a,"Tutorials","elbp_tutorial_new_targets")})},add_existing_target:function(a){$("#loading_add_existing_target").show();var b={targetID:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("Tutorials","get_target_row",b,function(a){$("#elbp_tutorial_new_targets").append(a),$("#loading_add_existing_target").hide()})},remove_target:function(targetID,tutorialID){var confirm=window.confirm(ELBP.strings.areyousureremovetarget);if(confirm){void 0==tutorialID&&$("#new_added_target_id_"+targetID).remove();var params={studentID:ELBP.studentID,courseID:ELBP.courseID,tutorialID:tutorialID,targetID:targetID};ELBP.ajax("Tutorials","remove_target",params,function(d){eval(d)})}},save_tutorial:function(form){var data=form.serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax("Tutorials","save_tutorial",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#new_tutorial_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},edit_tutorial:function(a){var b={type:"edit",tutorialID:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("Tutorials","load_display_type",b,function(a){$("#elbp_tutorials_content").html(a)},function(a){$("#elbp_tutorials_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},delete_tutorial:function(id){var confirm=window.confirm(ELBP.strings.areyousuredelete);if(confirm){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,tutorialID:id};ELBP.ajax("Tutorials","delete_tutorial",params,function(d){eval(d)})}},auto_save:function(){var data=$("#new_tutorial_form").serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID,auto:1}),ELBP.ajax("Tutorials","save_tutorial",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#new_tutorial_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},ELBP.Attachments={load_display:function(a,b){var c={type:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("Attachments","load_display_type",c,function(a){$("#elbp_attachments_content").html(a),ELBP.set_view_link(b)},function(a){$("#elbp_attachments_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},delete_attachment:function(id){var confirm=window.confirm(ELBP.strings.areyousuredelete);if(confirm){var data={id:id,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("Attachments","delete",data,function(d){eval(d)},function(a){$("#attachments_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},add_comment:function(id,comment,parentID){var params={id:id,comment:comment,parentID:parentID};ELBP.ajax("Attachments","add_comment",params,function(d){eval(d)})},delete_comment:function(id){var params={id:id};ELBP.ajax("Attachments","delete_comment",params,function(d){eval(d)})}},ELBP.CourseReports={load_display:function(a,b,c,d,e){var f={type:a,studentID:ELBP.studentID,courseID:ELBP.courseID,courseIDForReport:c,reportID:d};ELBP.ajax("CourseReports","load_display_type",f,function(a){$("#elbp_course_reports_content").html(a),ELBP.set_view_link(b),e&&e()},function(a){$("#elbp_course_reports_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />');
})},save:function(data){$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax("CourseReports","save_report",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#new_course_report_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},load_report:function(a,b){var c=ELBP.courseID;ELBP.courseID=a,ELBP.load_expanded("CourseReports"),ELBP.courseID=c},load_report_quick:function(a,b){ELBP.CourseReports.load_display("course",void 0,a,void 0,function(){$("div#elbp_popup").scrollTop(0);var a=$("#course_report_content_"+b).offset().top-$("#course_report_content_"+b).height();$("#course_report_content_"+b).slideDown(),$("div#elbp_popup").animate({scrollTop:a},2e3)})},delete_report:function(id){var confirm=window.confirm(ELBP.strings.areyousuredelete);if(confirm){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,reportID:id};ELBP.ajax("CourseReports","delete_report",params,function(d){eval(d)})}},search:function(a,b){if(""==a||""==b)return!1;var c={studentID:ELBP.studentID,courseID:ELBP.courseID,dateFrom:a,dateTo:b};ELBP.ajax("CourseReports","search",c,function(a){$("#elbp_periodical_output").html(a)},function(a){$("#elbp_periodical_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},save_periodical:function(data){$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax("CourseReports","save_periodical",data,function(d){eval(d)},function(a){$("#elbp_periodical_saving_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},edit_periodical:function(a){var b={studentID:ELBP.studentID,courseID:ELBP.courseID,reportID:a};ELBP.ajax("CourseReports","edit_periodical",b,function(a){$("#elbp_periodical_output").html(a)},function(a){$("#elbp_periodical_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},delete_periodical:function(id){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,reportID:id};ELBP.ajax("CourseReports","delete_periodical",params,function(d){eval(d)},function(a){$("#elbp_periodical_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},load_periodical:function(a){ELBP.load_expanded("CourseReports",function(){$(document).ready(function(){setTimeout("ELBP.CourseReports.load_display('periodical_report', false, false, "+a+");",2500)})})}},ELBP.Comments={load_display:function(a,b){var c={type:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("Comments","load_display_type",c,function(a){$("#elbp_comments_content").html(a),ELBP.set_view_link(b)},function(a){$("#elbp_comments_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},save:function(form){var data=form.serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax("Comments","save_comment",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#new_comment_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},edit_comment:function(a){var b={type:"edit",commentID:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("Comments","load_display_type",b,function(a){$("#elbp_comments_content").html(a)},function(a){$("#elbp_comments_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},delete_comment:function(id){var confirm=window.confirm(ELBP.strings.areyousuredelete);if(confirm){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,commentID:id};ELBP.ajax("Comments","delete_comment",params,function(d){eval(d)},function(a){$("#elbp_comments_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},load_comment:function(a){ELBP.load_expanded("Comments",function(){var b=function(){var b=$("#elbp_comment_"+a).offset().top-$("#elbp_comment_"+a).height();$("#comment_content_"+a).slideDown(),$("div#elbp_popup").scrollTop(0),$("div#elbp_popup").animate({scrollTop:b},2e3)};setTimeout(b,1e3)})},mark_resolved:function(id,val){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,commentID:id,val:val};ELBP.ajax("Comments","mark_resolved",params,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#elbp_comments_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},ELBP.AdditionalSupport={load_display:function(a,b){var c={type:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("AdditionalSupport","load_display_type",c,function(a){$("#elbp_additional_support_content").html(a),ELBP.set_view_link(b)},function(a){$("#elbp_additional_support_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},add_target:function(a){ELBP.save_state("AdditionalSupport"),ELBP.dock("AdditionalSupport",a),ELBP.Targets.loaded_from="AdditionalSupport",ELBP.load_expanded("Targets",function(){ELBP.Targets.load_display("new",void 0,void 0,"AdditionalSupport","elbp_additional_support_new_targets")})},edit_target:function(a,b){ELBP.save_state("AdditionalSupport"),ELBP.dock("AdditionalSupport",b),ELBP.Targets.loaded_from="AdditionalSupport",ELBP.load_expanded("Targets",function(){ELBP.Targets.edit_target(a,"AdditionalSupport","elbp_additional_support_new_targets")})},remove_target:function(targetID,sessionID){var confirm=window.confirm(ELBP.strings.areyousureremovetarget);if(confirm){void 0==sessionID&&$("#new_added_target_id_"+targetID).remove();var params={studentID:ELBP.studentID,courseID:ELBP.courseID,sessionID:sessionID,targetID:targetID};ELBP.ajax("AdditionalSupport","remove_target",params,function(d){eval(d)})}},save:function(form){var data=form.serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax("AdditionalSupport","save",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#new_additional_support_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},load_session:function(a){ELBP.load_expanded("AdditionalSupport",function(){setTimeout("$('#additional_support_content_"+a+"').show();$('div#elbp_popup').scrollTop(0);$('div#elbp_popup').animate({ scrollTop: ($('#elbp_additional_support_"+a+"').offset().top - $('#elbp_additional_support_"+a+"').height()) }, 2000);",1e3)})},edit_session:function(a){var b={type:"edit",sessionID:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("AdditionalSupport","load_display_type",b,function(a){$("#elbp_additional_support_content").html(a)},function(a){$("#elbp_additional_support_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},delete_session:function(id){var confirm=window.confirm(ELBP.strings.areyousuredelete);if(confirm){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,sessionID:id};ELBP.ajax("AdditionalSupport","delete",params,function(d){$("#elbp_popup").scrollTop(0),eval(d)})}},update_target_confidence:function(type,value,sessionID,targetID){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,sessionID:sessionID,targetID:targetID,type:type,value:value};ELBP.ajax("AdditionalSupport","update_target_confidence",params,function(d){eval(d)},function(a){$("#additional_support_target_output_session_"+sessionID).html('<img src="'+ELBP.wwww+'/blocks/elbp/pix/loader.gif" alt="" />')})},update_target_status:function(statusID,targetID,sessionID){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,sessionID:sessionID,targetID:targetID,statusID:statusID};ELBP.ajax("AdditionalSupport","update_target_status",params,function(d){eval(d)},function(a){$("#additional_support_target_output_session_"+sessionID).html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},add_comment:function(id,comment,parentID){if(""!=comment){var params={sessionID:id,comment:comment,parentID:parentID};ELBP.ajax("AdditionalSupport","add_comment",params,function(d){eval(d),$('#elbp_additional_support_content input[type="button"]').removeAttr("disabled")},function(a){void 0!=parentID?$("#elbp_comment_add_output_comment_"+parentID).html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />'):$("#elbp_comment_add_output_"+id).html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />'),$('#elbp_additional_support_content input[type="button"]').attr("disabled","disabled")})}},delete_comment:function(sessionID,commentID){var confirm=window.confirm(ELBP.strings.areyousuredelete);if(confirm){var params={sessionID:sessionID,commentID:commentID};ELBP.ajax("AdditionalSupport","delete_comment",params,function(d){eval(d)},function(a){$("#elbp_comment_add_output_"+sessionID).html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},save_attribute:function(attribute,value){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,attribute:attribute,value:value};ELBP.ajax("AdditionalSupport","save_attribute",params,function(d){eval(d)},function(a){$("#elbp_additional_support_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},add_existing_target:function(a){if(0==$("#new_added_target_id_"+a).length){$("#loading_add_existing_target").show();var b={targetID:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("AdditionalSupport","get_target_row",b,function(a){$("#elbp_additional_support_new_targets").append(a),$("#loading_add_existing_target").hide()})}},auto_save:function(){var data=$("#new_additional_support_form").serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID,auto:1}),ELBP.ajax("AdditionalSupport","save",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#new_additional_support_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},ELBP.Challenges={save:function(form){var data=form.serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax("Challenges","save",data,function(d){eval(d)},function(a){$("#challenges_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},ELBP.LearningStyles={load_display:function(a){var b={type:a,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax("LearningStyles","load_display_type",b,function(a){$("#elbp_learning_styles_content").html(a)},function(a){$("#elbp_learning_styles_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},save:function(form){var data=form.serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax("LearningStyles","save",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#elbp_learning_styles_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},ELBP.Custom={load_display:function(a,b,c){var d={type:b,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax(a,"load_display_type",d,function(a){$("#elbp_custom_content").html(a),ELBP.set_view_link(c)},function(a){$("#elbp_custom_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},save_single:function(plugin,form){var data=form.serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax(plugin,"save_single",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#custom_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},save_incremental:function(plugin,form){var data=form.serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax(plugin,"save_incremental",data,function(d){eval(d),ELBP.Custom.refresh_incremental(plugin),$(form)[0].reset()},function(a){$("#elbp_popup").scrollTop(0),$("#custom_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},delete_incremental_item:function(plugin,id){var confirm=window.confirm(ELBP.strings.areyousuredelete);if(confirm){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,itemID:id};ELBP.ajax(plugin,"delete_incremental_item",params,function(d){eval(d),ELBP.Custom.refresh_incremental(plugin)},function(a){$("#elbp_popup").scrollTop(0),$("#custom_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},refresh_incremental:function(a){var b={studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax(a,"refresh_incremental",b,function(a){$("#elbp_custom_plugin_items").html(a)},function(a){$("#elbp_popup").scrollTop(0),$("#elbp_custom_plugin_items").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},save_multi:function(plugin,form){var data=form.serialiseObject();$.extend(data,{studentID:ELBP.studentID,courseID:ELBP.courseID}),ELBP.ajax(plugin,"save_multi",data,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#custom_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})},delete_item:function(plugin,id){var confirm=window.confirm(ELBP.strings.areyousuredelete);if(confirm){var params={studentID:ELBP.studentID,courseID:ELBP.courseID,itemID:id};ELBP.ajax(plugin,"delete_item",params,function(d){eval(d)},function(a){$("#elbp_popup").scrollTop(0),$("#custom_output").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},edit_item:function(a,b){var c={type:"edit",itemID:b,studentID:ELBP.studentID,courseID:ELBP.courseID};ELBP.ajax(a,"load_display_type",c,function(a){$("#elbp_custom_content").html(a)},function(a){$("#elbp_popup").scrollTop(0),$("#elbp_custom_content").html('<img src="'+ELBP.www+'/blocks/elbp/pix/loader.gif" alt="" />')})}},ELBP.toggleBadges=function(){if($("#badges_content").length>0&&($("#badges_content").slideToggle(),$("#toggle-badges").length>0)){var a=$("#toggle-badges").attr("src");a.indexOf("switch_plus")>0?(a=a.replace("switch_plus","switch_minus"),ELBP.addCookie("hide_elbp_badges",0)):(a=a.replace("switch_minus","switch_plus"),ELBP.addCookie("hide_elbp_badges",1)),$("#toggle-badges").attr("src",a)}},ELBP.getCookie=function(a){var b=document.cookie.split(" "),c={};for(i in b){var d=b[i].split("="),e=d[0],f=d[1];f=f.replace(";",""),c[e]=f}return c[a]},ELBP.addCookie=function(a,b){var c="";c+=a+"="+b,document.cookie=c},ELBP.bind=function(){if(console.log("binding ELBP"),ELBP.resize_popup(),$(window).resize(function(){ELBP.resize_popup()}),$("a.elbp_toggle").unbind("click"),$("a.elbp_toggle").bind("click",function(a){var b=$(this).attr("toggle");$(b).toggle(),a.preventDefault()}),$("select.elbp_toggle").unbind("change"),$("select.elbp_toggle").bind("change",function(a){var b=$(this).attr("toggle");$(b).toggle(),a.preventDefault()}),$(".elbp_datepicker").removeClass("hasDatepicker"),$(".elbp_datepicker").datepicker("destroy"),$(".elbp_datepicker").datepicker({dateFormat:"dd-mm-yy",changeMonth:!0,changeYear:!0}),$(".elbp_datepicker_no_past").datepicker({dateFormat:"dd-mm-yy",changeMonth:!0,changeYear:!0,minDate:0}),$(".elbp_datepicker_no_future").datepicker({dateFormat:"dd-mm-yy",changeMonth:!0,changeYear:!0,maxDate:0}),$(".elbp_datepicker, .elbp_datepicker_no_past, .elbp_datepicker_no_future").attr("placeholder","dd-mm-yyyy"),void 0!==$().raty&&($(".elbp_rate").raty("destroy"),$(".elbp_rate").raty({score:function(){return $(this).attr("data-score")},scoreName:function(){return $(this).attr("score-name")},readOnly:function(){return 1==$(this).attr("data-readonly")},number:function(){return $(this).attr("data-number")}})),$("#elbp_popup").draggable({handle:"div.elbp_popup_header"}),$(".elbp_fileupload").each(function(){var a=$(this).attr("id");$(this).fileupload({url:M.cfg.wwwroot+"/blocks/elbp/upload.php",dataType:"json",formData:{sid:"<?= $obj->getStudentID(); ?>"},send:function(b,c){$("#output_messages-"+a).html(""),$("#filevalue-"+a).html(""),$("#progress-"+a).show()},done:function(b,c){c.result.success===!0?$("#output_messages-"+a).append('<div class="elbp_success_box"><span>'+ELBP.strings.uploaded+": "+c.result.title+"</span></div>"):$("#output_messages-"+a).append('<div class="elbp_err_box"><span>'+c.result.error+"</span></div>"),$("#progress-"+a).hide(),$("#progress-amount-"+a).css("width",0),$("#hidden-file-"+a).val(c.result.tmp)},fail:function(b,c){$("#output_messages-"+a).html('<div class="elbp_err_box"><span>'+ELBP.strings["uploads:unknownerror"]+"</span></div>"),$("#progress-"+a).hide()},progressall:function(b,c){var d=parseInt(c.loaded/c.total*100,10);$("#progress-amount-"+a).css("width",d+"%")}}).prop("disabled",!$.support.fileInput).parent().addClass($.support.fileInput?void 0:"disabled")}),$.fn.serialiseObject=function(){var a={},b=this,c=this.serializeArray();$.each(c,function(){var b=this.name,c=b.match(/\[(\d+|\w+|)\]/);if(null!=c){var d=c[1],e=b.split("[")[0];a[e]||(a[e]=[]),""!=d?a[e][d]=this.value||"":a[e].push(this.value||"")}else a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""});var d=$(this).find(".elbp_texteditor");return $(d).each(function(){var c=$(this).attr("id"),d=$(this).attr("name"),e="",f=$(b).find("#"+c+"_ifr"),g=$(b).find("#"+c+"editable");e=f.length>0?$(f).contents().find("body").html():g.length>0?$(g).html():$(b).find("#"+c).val(),a[d]=e}),a},$(".elbp_required_field").remove(),$('[validation*="REQUIRED"]').after('<span class="elbp_required_field" title="'+ELBP.strings.requiredfield+'">*</span>'),$(".target_name_tooltip").tooltip(),$(".dock_plugin_close img").mouseover(function(){var a=$(this).attr("src");$(this).attr("src",a.replace("close_tiny.png","close_tiny_hover.png"))}),$(".dock_plugin_close img").mouseout(function(){var a=$(this).attr("src");$(this).attr("src",a.replace("close_tiny_hover.png","close_tiny.png"))}),1==ELBP.getCookie("hide_elbp_badges")&&$("#toggle-badges").length>0){var src=$("#toggle-badges").attr("src");src=src.replace("switch_minus","switch_plus"),$("#toggle-badges").attr("src",src)}$(".elbp_progress_traffic_light").off("click"),$(".elbp_progress_traffic_light").on("click",function(){var a=$(this).attr("rankNum");"none"==$("#elbp_progress_traffic_light_desc_"+a).css("display")?($(".elbp_progress_traffic_light_desc").hide(),$("#elbp_progress_traffic_light_desc_"+a).show()):$(".elbp_progress_traffic_light_desc").hide()}),$(".elbp_set_student_manual_progress").off("click"),$(".elbp_set_student_manual_progress").on("click",function(){var rank=$(this).attr("rankNum"),params={studentID:ELBP.studentID,rank:rank};ELBP.ajax(0,"set_student_manual_progress",params,function(d){eval(d),$("#elbp_progress_traffic_loading").html("")},function(a){$("#elbp_progress_traffic_loading").html('<img src="'+M.cfg.wwwroot+'/blocks/elbp/pix/loader.gif" alt="" />')})}),$(".elbp_summary_box_wrapper").hover(function(){var a=$(this).height(),b=$(this)[0].scrollHeight;b>a&&$(this).next(".elbp_summary_box_footer").slideDown("slow")}),$(".file-drop-zone").off("dragenter"),$(".file-drop-zone").on("dragenter",function(a){$(this).addClass("in")}),$(".file-drop-zone").off("dragleave dragend"),$(".file-drop-zone").on("dragleave dragend",function(a){$(this).removeClass("in")}),ELBP.apply_tooltip();var loadAlertsTable=function(a,b){return"course"!=a&&"student"!=a||""!=b?void ELBP.ajax(null,"get_alerts_table",{type:a,value:b},function(a){$("#alerts_div").html(a)},function(){$("#alerts_div").html('<img src="'+M.cfg.wwwroot+'/blocks/elbp/pix/loader.gif" alt="loading" />')}):void $("#alerts_div").html("")};$(".elbp_settings_change_alert_type").unbind("click"),$(".elbp_settings_change_alert_type").bind("click",function(a){var b=$(this).attr("type");$("#alerts_div").html(""),$(".switch_alerts").hide(),$(".switch_alerts").each(function(){$(this).attr("type")==b&&$(this).show()}),"mentees"!=b&&"addsup"!=b||loadAlertsTable(b),a.preventDefault()}),$(".switch_alerts").unbind("change"),$(".switch_alerts").bind("change",function(){var a=$(this).attr("type"),b=$(this).val();loadAlertsTable(a,b)}),$(".elbp_remove").off("click"),$(".elbp_remove").on("click",function(a){var b=$(this).attr("remove");"parent-row"===b&&(b=$($(this).parents("tr")[0])),void 0!==b&&$(b).remove(),a.preventDefault()}),$(".elbp_add_progress_colour").off("click"),$(".elbp_add_progress_colour").on("click",function(a){var b="";b+="<tr>",b+="<td><input type='number' name='progress_ranks[]' value='' placeholder='1' /></td>",b+="<td><input type='text' name='progress_titles[]' value='' placeholder='At Risk' /></td>",b+="<td><input type='color' name='progress_colours[]' value='' placeholder='#000000' /></td>",b+="<td><input type='text' name='progress_desc[]' value='' placeholder='You are at risk of failing your course' /></td>",b+="<td><a href='#' class='elbp_remove' remove='parent-row'><img src='"+M.util.image_url("t/delete")+"' /></a></td>",b+="</tr>",$("#elbp_manual_progress_colours").append(b),ELBP.bind(),a.preventDefault()});var rebuild_plugin_path=function(a){var b=$("#elbp_install_plugin_change_type").val(),c=$("#elbp_install_plugin_change_external_type").val();dir="/","core"==b?dir+="blocks/elbp/plugins/":"external"==b&&"other"!=c&&(dir=dir+c+"/");var d="external"===b&&void 0!==a&&a.indexOf("elbp_")<0?"elbp_":"";return dir=dir+a+"/"+d+a+".class.php","external"==b&&"other"==c&&(dir="/path/to/plugin/file.php"),$("#elbp_install_plugin_path").val(dir),dir};$("#elbp_install_plugin_change_type").off("change"),$("#elbp_install_plugin_change_type").on("change",function(){var a=$(this).val();if($("#elbp_install_plugin_change_external_type").parent().hide(),$("#elbp_install_plugin_name").parent().hide(),$("#elbp_install_plugin_path").parent().hide(),$("#elbp_install_plugin_path").val(""),$("#elbp_install_plugin_submit").hide(),"core"===a){$("#elbp_install_plugin_name").parent().show(),$("#elbp_install_plugin_name").html('<option value=""></option>');var b=$("hidden > core > name");$.each(b,function(a,b){$("#elbp_install_plugin_name").append('<option value="'+$(b).text()+'">'+$(b).text()+"</option>")})}else"external"===a&&$("#elbp_install_plugin_change_external_type").parent().show()}),$("#elbp_install_plugin_name").off("change"),$("#elbp_install_plugin_name").on("change",function(){var a=$(this).val();""===a?($("#elbp_install_plugin_path").parent().hide(),$("#elbp_install_plugin_path").val(""),$("#elbp_install_plugin_submit").hide()):(rebuild_plugin_path(a),$("#elbp_install_plugin_path").parent().show(),$("#elbp_install_plugin_submit").show())}),$("#elbp_install_plugin_change_external_type").off("change"),$("#elbp_install_plugin_change_external_type").on("change",function(){var a=$(this).val();if($("#elbp_install_plugin_name").parent().hide(),$("#elbp_install_plugin_submit").hide(),$("#elbp_install_plugin_path").parent().hide(),$("#elbp_install_plugin_path").val(""),"other"===a)rebuild_plugin_path(),$("#elbp_install_plugin_path").parent().show(),$("#elbp_install_plugin_submit").show();else{$("#elbp_install_plugin_name").parent().show(),$("#elbp_install_plugin_name").html('<option value=""></option>');var b=$("hidden > external > "+a+" > name");$.each(b,function(a,b){$("#elbp_install_plugin_name").append('<option value="'+$(b).text()+'">'+$(b).text()+"</option>")})}}),$(".elbp_add_plugin_group").off("click"),$(".elbp_add_plugin_group").on("click",function(a){var b=$(this).attr("layout"),c=$(".layout_group_"+b).length,d=c+1,e="";e+="<tr class='layout_group_"+b+"_"+d+"_row'>",e+="<td>",e+="<a href='#' class='elbp_remove' remove='.layout_group_"+b+"_"+d+"_row'><img src='"+M.cfg.wwwroot+"/blocks/elbp/pix/remove.png' alt='"+ELBP.strings["delete"]+"' /></a>",e+="</td>",e+="</tr>",e+="<tr class='layout_group_"+b+" layout_group_"+b+"_"+d+"_row'>",e+="<td>"+ELBP.strings.name+"</td>",e+="<td>",e+="<input type='hidden' name='plugin_layouts_groups_id["+b+"]["+d+"]' value='' />",e+="<input type='text' name='plugin_layouts_groups_name["+b+"]["+d+"]' value='' />",e+="</td>",e+="</tr>",e+="<tr class='layout_group_"+b+"_"+d+"_row'>",e+="<td>"+ELBP.strings.enabled+"</td>",e+="<td>",e+="<input type='checkbox' name='plugin_layouts_groups_enabled["+b+"]["+d+"]' value='1' />",e+="</td>",e+="</tr>",e+="<tr class='layout_group_"+b+"_"+d+"_row'>",e+="<td>"+ELBP.strings.plugins+"</td>",e+="<td>",e+="<small><a href='#' class='elbp_toggle_add_plugins_to_group elbp_add_layout_plugins_link_layout_"+b+"' layout='"+b+"' groupID='D"+d+"' groupNum='"+d+"' isAdding='0' id='elbp_add_layout_plugins_link_"+b+"_"+d+"'>"+ELBP.strings.startaddingplugins+"</a></small>",e+="<div class='elbp_layout_plugins_dump elbp_layout_plugins_dump_"+b+"' id='elbp_layout_plugins_dump_"+b+"_"+d+"' groupNum='"+d+"' layoutNum='"+b+"'><ul></ul></div>",e+="</td>",e+="</tr>",e+="<tr class='layout_group_"+b+"_"+d+"_row'>",e+="<td colspan='2'><br></td>",e+="</tr>",$("#elbp_plugin_layout_"+b).append(e),ELBP.bind(),a.preventDefault()}),$(".elbp_remove_plugin_from_group").off("click"),$(".elbp_remove_plugin_from_group").on("click",function(a){var b=$(this).attr("layout"),c=$(this).attr("pluginID");$(this).parent().remove(),$("#plugin_"+c+"_"+b).show(),a.preventDefault()}),$(".elbp_toggle_add_plugins_to_group").off("click"),$(".elbp_toggle_add_plugins_to_group").on("click",function(a){var b=$(this).attr("layout"),c=$(this).attr("groupNum"),d=$("#elbp_add_layout_plugins_link_"+b+"_"+c).attr("isAdding");$(".elbp_add_layout_plugins_link_layout_"+b).attr("isAdding",0),$(".elbp_add_layout_plugins_link_layout_"+b).text(ELBP.strings.startaddingplugins),$(".elbp_layout_plugins_dump_"+b+" ul").removeClass("active"),0==d&&($("#elbp_add_layout_plugins_link_"+b+"_"+c).attr("isAdding",1),$("#elbp_add_layout_plugins_link_"+b+"_"+c).text(ELBP.strings.stopaddingplugins),$("#elbp_layout_plugins_dump_"+b+"_"+c+" ul").addClass("active")),a.preventDefault()}),$(".elbp_add_new_plugin_layout").off("click"),$(".elbp_add_new_plugin_layout").on("click",function(a){var b=$(".elbp_plugin_layouts").length,c=b+1,d=$("hidden > plugins > plugin"),e="";e+="<table id='elbp_plugin_layout_"+c+"' class='elbp_plugin_layouts'>",e+="<tr>",e+="<td>",e+="<a href='#' class='elbp_remove' remove='#elbp_plugin_layout_"+c+"'><img src='"+M.cfg.wwwroot+"/blocks/elbp/pix/remove.png' alt='"+ELBP.strings["delete"]+"' /></a>",e+="</td>",e+="</tr>",e+="<tr>",e+="<td>"+ELBP.strings.layoutname+"</td>",e+="<td><input type='hidden' name='plugin_layouts_id["+c+"]' value='' /><input type='text' name='plugin_layouts_name["+c+"]' value='' /></td>",e+="</tr>",e+="<tr>",e+="<td>"+ELBP.strings["default"]+"</td>",e+="<td><input type='checkbox' name='plugin_layouts_default["+c+"]' value='1' /></td>",e+="</tr>",e+="<tr>",e+="<td>"+ELBP.strings.enabled+"</td>",e+="<td><input type='checkbox' name='plugin_layouts_enabled["+c+"]' value='1' /></td>",e+="</tr>",e+="<tr>",e+="<td colspan='2'>",$.each(d,function(a,b){var d=$(b).find("id").text(),f=$(b).find("name").text(),g=$(b).find("bg").text(),h=$(b).find("font").text(),i=$(b).find("custom").text(),j="1"==i?"c":"";e+="<div class='elbp_add_plugin_to_group elbp_layout_plugin_name' id='plugin_"+j+d+"_"+c+"' layoutNum='"+c+"' pluginID='"+d+"' style='background-color:"+g+";color:"+h+";' >"+f+"</div>"}),e+="</td>",e+="</tr>",e+="<tr>",e+="<th colspan='2'>"+ELBP.strings.groups+" <a href='#' class='elbp_add_plugin_group' layout='"+c+"'><img src='"+M.cfg.wwwroot+"/blocks/elbp/pix/add_small.png' alt='"+ELBP.strings.addnewgroup+"' /></a></th>",e+="</tr>",e+="</table>",$("#elbp_plugin_layouts_form").append(e),ELBP.bind(),a.preventDefault()}),$(".elbp_add_plugin_to_group").off("click"),$(".elbp_add_plugin_to_group").on("click",function(a){var b=$(this).attr("layoutNum"),c=$(this).attr("pluginID"),d=!1,e=$(".elbp_add_layout_plugins_link_layout_"+b);if($.each(e,function(a,b){var c=$(b).attr("isAdding");if(1==c)return void(d=$(b).attr("groupNum"))}),!d)return alert(ELBP.strings.plschooseplugingroup),!1;var f=$("#plugin_"+c+"_"+b);$("#plugin_"+c+"_"+b).hide(),$("#elbp_layout_plugins_dump_"+b+"_"+d+" ul").append('<li pluginID="'+c+'">'+$(f).text()+' <a href="#" class="elbp_remove_plugin_from_group" layout="'+b+'" pluginID="'+c+'"><img src="'+M.cfg.wwwroot+'/blocks/elbp/pix/close_tiny.png" alt="'+ELBP.strings.remove+'" /></a><input type="hidden" name="layout_group_plugins['+b+"]["+d+'][]" value="'+c+'" /></li>'),ELBP.bind()}),$(".elbp_layout_plugins_dump ul").sortable({placeholder:"elbp_layout_plugin_placeholder"}),$(".elbp_layout_plugins_dump ul").disableSelection(),$("#elbp_attributes_table tbody").sortable({containerSelector:"tbody",itemSelector:"tr",cancel:".noSort",update:function(a,b){resortNumbers("elbp_attributes_table tbody")}}),$("#elbp_loading_overlay").fadeOut()},window.ELBP=ELBP,client.scripts=ELBP,client.log=function(a){console.log("[ELBP] "+(new Date).toTimeString().split(" ")[0]+": "+a)},client.init=function(){client.log("Loading initial state"),ELBP.ajax(0,"get_initial_state")},client.view=function(a,b,c){client.log("Loading student and course into ELBP"),ELBP.studentID=a,ELBP.courseID=b,c&&(client.log("Loading default plugin group"),ELBP.load("group",c.id))};var keyMap={16:!1,17:!1,220:!1},keyMapAdvanced={16:!1,17:!1,192:!1},keyMapClear={16:!1,17:!1,13:!1};return $(document).keydown(function(a){a.keyCode in keyMap&&(keyMap[a.keyCode]=!0,keyMap[16]&&keyMap[17]&&keyMap[220]&&"none"!=$("#elbp_popup").css("display")&&($("#elbp_popup").css("top","10%").css("left","10%"),ELBP.resize_popup())),a.keyCode in keyMapAdvanced&&(keyMapAdvanced[a.keyCode]=!0,keyMapAdvanced[16]&&keyMapAdvanced[17]&&keyMapAdvanced[192]&&($("#elbp_admin_blanket").toggle(),"none"!=$("#elbp_admin_blanket").css("display")?($("#cmd_input input").focus(),$("body").css("overflow","hidden")):$("body").css("overflow","auto"))),a.keyCode in keyMapClear&&(keyMapClear[a.keyCode]=!0,keyMapClear[16]&&keyMapClear[17]&&keyMapClear[13]&&($("#elbp_popup").hide(),ELBP.hide("#elbp_blanket"),$("body").css("overflow","auto")))}).keyup(function(a){$.each(keyMap,function(a,b){keyMap[a]=!1}),$.each(keyMapAdvanced,function(a,b){keyMapAdvanced[a]=!1}),$.each(keyMapClear,function(a,b){keyMapClear[a]=!1})}),$("#cmd_input #input").keydown(function(a){if(38==a.keyCode){if(ELBP.commandPointer-1>=0){ELBP.commandPointer--;var b=ELBP.savedCommands[ELBP.commandPointer];$("#cmd_input #input").val(""),$("#cmd_input #input").val(b)}}else if(40==a.keyCode&&ELBP.commandPointer+1<ELBP.savedCommands.length){ELBP.commandPointer++;var b=ELBP.savedCommands[ELBP.commandPointer];$("#cmd_input #input").val(""),$("#cmd_input #input").val(b)}}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Object.keys=Object.keys||function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on a non-object");var f=[];for(var g in e)a.call(e,g)&&f.push(g);if(b)for(var h=0;h<d;h++)a.call(e,c[h])&&f.push(c[h]);return f}}(),client});